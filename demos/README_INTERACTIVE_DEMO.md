# IBDM-NLU Interactive Demo

An interactive demonstration of the IBDM-NLU integration for legal document generation (NDA drafting).

## Overview

This demo showcases:
- **Natural Language Understanding**: LLM-based interpretation of user utterances
- **Dialogue Management**: IBDM question-under-discussion (QUD) stack and dialogue moves
- **Entity Extraction**: Recognition of legal entities (organizations, dates, jurisdictions)
- **Task Accommodation**: System infers document requirements from conversation
- **Real-time Metrics**: Token usage, costs, and latency tracking

## Prerequisites

1. **Python 3.10+** with the IBDM package installed
2. **IBDM_API_KEY** environment variable set with your Anthropic Claude API key
3. **Dependencies**: The demo requires the `rich` library for terminal UI

## Installation

```bash
# Install IBDM with development dependencies
uv pip install --system -e ".[dev]"

# Or if using regular pip
pip install -e ".[dev]"
```

## Running the Demo

### Basic Usage

```bash
python demos/03_nlu_integration_interactive.py
```

### With Options

```bash
# Verbose mode (shows detailed NLU processing)
python demos/03_nlu_integration_interactive.py --verbose

# Without colors (for plain terminals)
python demos/03_nlu_integration_interactive.py --no-color

# Help
python demos/03_nlu_integration_interactive.py --help
```

## Sample Conversation

Here's a complete example conversation showing the system in action:

```
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                       â”‚
â”‚  IBDM-NLU Interactive Demo                           â”‚
â”‚  Legal Document Generation: Non-Disclosure Agreement â”‚
â”‚                                                       â”‚
â”‚  Type your messages to interact with the legal       â”‚
â”‚  document system                                     â”‚
â”‚  Type 'quit' or 'exit' to end the session           â”‚
â”‚                                                       â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

âœ“ API key found

Validating configuration...
  âœ“ All modules available
  âœ“ Loaded 16 IBDM rules
  âœ“ Configuration validated

Configuration:
  â€¢ Model: claude-sonnet-4-5-20250929
  â€¢ Rules: 16 IBDM rules loaded
  â€¢ API Key: IBDM_API_KEY (âœ“ set)

âœ“ Burr state machine initialized with NLU engine

Starting Interactive Session

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Legal System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                            â”‚
â”‚  System: Hello! I'm here to help you draft a Non-Disclosure Agreement.    â”‚
â”‚  What would you like to do?                                               â”‚
â”‚                                                                            â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯


You: I need to draft an NDA

================================================================================
Turn 1
================================================================================

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ You (Turn 1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                             â”‚
â”‚  I need to draft an NDA                                                    â”‚
â”‚                                                                             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

 Strategy:  ğŸ”´ sonnet
 Tokens:    1234 (617 in / 617 out)
 Cost:      $0.011085
 Latency:   2.145s

âœ“ Interpreted 1 dialogue move(s)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Dialogue Move â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  Move Type: command                                                    â”‚
â”‚  Speaker: user                                                         â”‚
â”‚  Content: I need to draft an NDA                                       â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ QUD Stack â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  QUD Stack (bottom â†’ top)                                              â”‚
â”‚  â“ WhQuestion(variable='x', predicate='draft_nda_task') (0)          â”‚
â”‚  â“ WhQuestion(variable='parties', predicate='nda_parties') (TOP)     â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Legal System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  I'll help you draft an NDA. What are the names of the parties        â”‚
â”‚  entering into this agreement?                                         â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯


You: Between Acme Corporation and TechStart Inc

================================================================================
Turn 2
================================================================================

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ You (Turn 2) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                             â”‚
â”‚  Between Acme Corporation and TechStart Inc                                â”‚
â”‚                                                                             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

 Strategy:  ğŸ”´ sonnet
 Tokens:    1456 (728 in / 728 out)
 Cost:      $0.013104
 Latency:   2.567s

âœ“ Interpreted 1 dialogue move(s)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Dialogue Move â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  Move Type: answer                                                     â”‚
â”‚  Speaker: user                                                         â”‚
â”‚  Content: Answer(content='Between Acme Corporation and TechStart Inc', â”‚
â”‚           addresses_question=WhQuestion(...))                           â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ QUD Stack â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  QUD Stack (bottom â†’ top)                                              â”‚
â”‚  â“ WhQuestion(variable='x', predicate='draft_nda_task') (0)          â”‚
â”‚  âš¡ AltQuestion(alternatives=['mutual', 'one-way']) (TOP)             â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Legal System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  Thank you. Should this be a mutual NDA or a one-way NDA?             â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯


You: Make it mutual

================================================================================
Turn 3
================================================================================

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ You (Turn 3) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                             â”‚
â”‚  Make it mutual                                                            â”‚
â”‚                                                                             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

 Strategy:  ğŸ”´ sonnet
 Tokens:    892 (446 in / 446 out)
 Cost:      $0.008028
 Latency:   1.834s

âœ“ Interpreted 1 dialogue move(s)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Dialogue Move â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  Move Type: answer                                                     â”‚
â”‚  Speaker: user                                                         â”‚
â”‚  Content: Answer(content='Make it mutual', addresses_question=...)     â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ QUD Stack â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  QUD Stack (bottom â†’ top)                                              â”‚
â”‚  â“ WhQuestion(variable='x', predicate='draft_nda_task') (0)          â”‚
â”‚  â“ WhQuestion(variable='date', predicate='effective_date') (TOP)     â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Legal System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                         â”‚
â”‚  Got it. What should the effective date be?                            â”‚
â”‚                                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯


You: quit

Ending session...

================================================================================
Session Summary
================================================================================

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                        â”‚
â”‚                          Session Metrics                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  Metric                                               Value            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                        â”‚
â”‚  Total Turns                                              3            â”‚
â”‚  Total Tokens                                         3,582            â”‚
â”‚  Total Cost                                      $0.032217            â”‚
â”‚  Avg Latency                                         2.182s            â”‚
â”‚  Total Latency                                       6.546s            â”‚
â”‚                                                                        â”‚
â”‚  Strategy Distribution                                                 â”‚
â”‚    ğŸ”´ sonnet                                     3 (100.0%)           â”‚
â”‚                                                                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

âœ“ Interactive session completed!
Processed 3 turns using claude-sonnet-4-5-20250929
```

## Understanding the Output

### Dialogue Moves

The system displays the interpreted dialogue move for each utterance:

- **command**: User giving an instruction or expressing a need ("I need to...", "I want to...")
- **question**: User asking for information
- **answer**: User providing information in response to a system question
- **assert**: User making a statement

### QUD Stack

The Question Under Discussion (QUD) stack shows:
- **Current focus**: What question is being addressed (shown at TOP)
- **Stack depth**: Previous questions still pending
- **Question types**:
  - â“ **WhQuestion**: Open-ended questions (who, what, where, when)
  - âœ“ **YNQuestion**: Yes/no questions
  - âš¡ **AltQuestion**: Alternative choice questions (A or B?)

### Metrics

For each turn, you'll see:

- **Strategy**: Which approach was used
  - ğŸ”´ **Sonnet**: Claude Sonnet 4.5 (most capable, higher cost)
  - ğŸŸ¡ **Haiku**: Claude Haiku 4.5 (fast, lower cost)
  - ğŸŸ¢ **Rules**: Pattern-based rules (free, instant)

- **Tokens**: Number of tokens consumed
  - Format: `total (input / output)`

- **Cost**: Estimated cost in USD
  - Sonnet: $3/million input, $15/million output
  - Haiku: $1/million input, $5/million output

- **Latency**: Time taken to process the utterance

## Tips for Interaction

1. **Be Natural**: The system handles natural language, so speak naturally
   - âœ“ "I need to draft an NDA"
   - âœ“ "Between Acme Corp and TechStart"
   - âœ“ "Make it mutual"

2. **Provide Context**: Give enough information for the system to understand
   - âœ“ "Between Acme Corporation as disclosing party and TechStart Inc"
   - âœ— "Acme" (too vague)

3. **Follow the Flow**: The system guides you through required information
   - It asks for parties, type, dates, etc. in a logical order

4. **Exit Anytime**: Type any of these to end the session:
   - `quit`
   - `exit`
   - `bye`
   - `goodbye`

## Verbose Mode

Use `--verbose` to see detailed NLU processing:

```bash
python demos/03_nlu_integration_interactive.py --verbose
```

This shows:
- Dialogue act classification confidence scores
- Entity extraction details
- Semantic parsing results
- Internal reasoning steps

## Troubleshooting

### "IBDM_API_KEY environment variable not found"

Set your Anthropic API key:

```bash
export IBDM_API_KEY='sk-ant-api03-...'
```

Or add it to your `.env` file in the project root.

### "No module named 'rich'"

Install the required dependency:

```bash
uv pip install --system rich
# or
pip install rich
```

### High latency or costs

The demo uses Claude Sonnet 4.5 for high-quality NLU, which can be expensive for long conversations. For cost-sensitive testing:

1. Keep conversations short (3-5 turns)
2. Consider modifying the config to use Haiku for classification
3. Monitor the session summary metrics

## Architecture

The demo integrates several IBDM components:

1. **NLU Engine** (`NLUDialogueEngine`): Interprets user utterances using Claude
2. **Burr State Machine** (`DialogueStateMachine`): Manages dialogue state
3. **IBDM Rules**: Handle question integration, selection, and response generation
4. **Context Interpreter**: Provides semantic understanding and entity extraction

## Next Steps

- Explore the non-interactive demo: `demos/03_nlu_integration_basic.py`
- Read the IBDM documentation: `docs/`
- Review the NLU components: `src/ibdm/nlu/`
- Examine the integration rules: `src/ibdm/rules/integration_rules.py`

## Related Files

- **Demo script**: `demos/03_nlu_integration_interactive.py`
- **Non-interactive version**: `demos/03_nlu_integration_basic.py`
- **NLU engine**: `src/ibdm/engine/nlu_engine.py`
- **Burr integration**: `src/ibdm/burr_integration/`
