# Beads Task ZFC Alignment Analysis
**Date**: 2025-11-15
**Session**: claude/align-beads-with-zfc-01VTe7NhqivT6qiM9D9fXnDB

## Executive Summary

Current beads task priorities **DO NOT align** with ZFC selective compliance principles. The foundational Larsson algorithms (Phase 1) have the LOWEST priority (0), when they should be HIGHEST priority as they represent the core research contribution.

### Critical Misalignment

**Current State**: Priority 0 (Phase 1) < Priority 1 (Phase 2, 3) < Priority 2 (Phase 4-6) < Priority 3 (Phase 8)

**Should Be**:
- **Priority 3 (HIGHEST)**: Phase 1 - Larsson algorithms (intentional ZFC violation)
- **Priority 2**: Phase 2, 3 - Burr orchestration + Rules
- **Priority 1**: Phase 4-6 - Advanced dialogue features
- **Priority 0 (LOWEST)**: Phase 7, 8 - Integration, advanced features

## ZFC Compliance Framework

From CLAUDE.md Policy #14:

### ✅ Use ZFC (Delegate to AI)
- **Language Processing**: NLU/NLG, utterance interpretation, text generation
- **Infrastructure**: Burr orchestration, schema validation, structural safety

### ❌ Violate ZFC (Explicit Algorithms)
- **Dialogue Management**: Larsson's update rules
- **Semantic Operations**: domain.resolves(), type matching
- **QUD Operations**: Stack push/pop, plan progression

## Task-by-Task Analysis

### Phase 1: Core Foundation (ibdm-brm)
**Current Priority**: 0 (LOWEST)
**Recommended Priority**: 3 (HIGHEST)
**ZFC Classification**: **INTENTIONAL VIOLATION** (This is the research contribution)

#### Tasks:
1. **ibdm-brm.1**: Basic data structures (Question, Answer, DialogueMove, InformationState)
   - **ZFC Status**: Violation (domain semantics)
   - **Why**: These encode Larsson's formal semantics
   - **Priority**: 3 (HIGHEST)

2. **ibdm-brm.2**: Update rule system (UpdateRule, RuleSet)
   - **ZFC Status**: Violation (algorithmic reasoning)
   - **Why**: Core Larsson algorithms (Section 3.2-3.4)
   - **Priority**: 3 (HIGHEST)

3. **ibdm-brm.3**: DialogueMoveEngine
   - **ZFC Status**: Violation (dialogue logic)
   - **Why**: Implements rule application algorithm
   - **Priority**: 3 (HIGHEST)

4. **ibdm-brm.4**: Unit tests for data structures
   - **ZFC Status**: Compliant (verification)
   - **Priority**: 3 (tests for highest priority code)

5. **ibdm-brm.5**: Serialization/deserialization
   - **ZFC Status**: Compliant (pure IO)
   - **Priority**: 2 (infrastructure)

**Rationale**: Without these foundational structures and algorithms, nothing else can work. These ARE the IBDM system - everything else is either orchestration (ZFC-compliant) or language processing (ZFC-compliant).

---

### Phase 2: Burr Integration (ibdm-zfl)
**Current Priority**: 1
**Recommended Priority**: 2
**ZFC Classification**: **COMPLIANT** (Pure orchestration)

#### Tasks:
1. **ibdm-zfl.1**: Design Burr state machine
   - **ZFC Status**: Compliant (orchestration design)
   - **Why**: State lifecycle tracking (ZFC section: State Management)
   - **Priority**: 2

2. **ibdm-zfl.2**: Implement Burr actions
   - **ZFC Status**: Compliant (mechanical execution)
   - **Why**: Actions call engines (ZFC section: Mechanical Transforms)
   - **Priority**: 2

3. **ibdm-zfl.3**: Define state transitions
   - **ZFC Status**: Compliant (control flow)
   - **Why**: INTERPRET → INTEGRATE → SELECT → GENERATE is mechanical
   - **Priority**: 2

4. **ibdm-zfl.4**: State persistence
   - **ZFC Status**: Compliant (IO/plumbing)
   - **Why**: ZFC section: IO and Plumbing
   - **Priority**: 2

5. **ibdm-zfl.5**: Visualization
   - **ZFC Status**: Compliant (rendering)
   - **Why**: ZFC section: Formatting and rendering
   - **Priority**: 1 (nice-to-have)

**Rationale**: Burr is the "thin, safe, deterministic shell" around Larsson algorithms. Must have Phase 1 complete before this makes sense.

---

### Phase 3: Rule Development (ibdm-63p)
**Current Priority**: 1
**Recommended Priority**: 2 (mixed ZFC compliance)
**ZFC Classification**: **MIXED** (some compliant, some violations)

#### Tasks:
1. **ibdm-63p.1**: Interpretation rules
   - **ZFC Status**: **COMPLIANT** (delegate to AI)
   - **Why**: Utterance → DialogueMove should use Claude 4.5
   - **Priority**: 2
   - **Implementation**: Prompt engineering, not heuristics

2. **ibdm-63p.2**: Integration rules (QUD, commitments, agenda)
   - **ZFC Status**: **VIOLATION** (Larsson algorithms)
   - **Why**: Core update rules (Larsson Section 3.3)
   - **Priority**: 3 (should be in Phase 1!)
   - **Implementation**: Explicit algorithms

3. **ibdm-63p.3**: Selection rules
   - **ZFC Status**: **VIOLATION** (dialogue logic)
   - **Why**: Priority-based selection (Larsson Section 3.4)
   - **Priority**: 3 (should be in Phase 1!)
   - **Implementation**: Explicit priority ordering

4. **ibdm-63p.4**: Generation rules
   - **ZFC Status**: **COMPLIANT** (delegate to AI)
   - **Why**: DialogueMove → Utterance should use templates/LLM
   - **Priority**: 2
   - **Implementation**: Template selection or LLM generation

**Rationale**: This phase mixes ZFC-compliant (interpretation, generation) with ZFC-violations (integration, selection). Integration and selection should be promoted to Phase 1 priority.

---

### Phase 4: Accommodation (ibdm-x1g)
**Current Priority**: 2
**Recommended Priority**: 1
**ZFC Classification**: **VIOLATION** (semantic inference)

#### Tasks:
1-4. All accommodation tasks
   - **ZFC Status**: Violation (semantic reasoning)
   - **Why**: Plan inference is semantic analysis (forbidden by ZFC)
   - **Priority**: 1
   - **Implementation**: Domain-specific accommodation rules (Larsson Section 2.4.4)

**Rationale**: These are advanced Larsson features, lower priority than core mechanics but still algorithmic.

---

### Phase 5: Multi-Agent System (ibdm-tty)
**Current Priority**: 2
**Recommended Priority**: 1
**ZFC Classification**: **COMPLIANT** (coordination infrastructure)

#### Tasks:
1-6. All multi-agent tasks
   - **ZFC Status**: Compliant (orchestration)
   - **Why**: Multi-agent coordination is mechanical (state sync, turn-taking)
   - **Priority**: 1
   - **Implementation**: Pure orchestration with domain-agnostic protocols

**Rationale**: Extension of Burr orchestration to multiple agents. Lower priority than single-agent foundation.

---

### Phase 6: Grounding and ICM (ibdm-okw)
**Current Priority**: 2
**Recommended Priority**: 1
**ZFC Classification**: **VIOLATION** (dialogue semantics)

#### Tasks:
1-4. All grounding/ICM tasks
   - **ZFC Status**: Violation (dialogue logic)
   - **Why**: Grounding requires semantic understanding of mutual beliefs
   - **Priority**: 1
   - **Implementation**: Larsson grounding rules (Section 4.3)

**Rationale**: Advanced dialogue features, lower priority than core mechanics.

---

### Phase 7: Integration and Testing (ibdm-dus)
**Current Priority**: 1
**Recommended Priority**: 0 (depends on all other phases)
**ZFC Classification**: **COMPLIANT** (verification)

#### Tasks:
1-5. All testing/documentation tasks
   - **ZFC Status**: Compliant (verification, documentation)
   - **Priority**: 0 (end-to-end work, done last)

**Rationale**: Can't do end-to-end testing until foundational components exist.

---

### Phase 8: Advanced Features (ibdm-xeh)
**Current Priority**: 3
**Recommended Priority**: 0 (stretch goals)
**ZFC Classification**: **COMPLIANT** (infrastructure extensions)

#### Tasks:
1-5. NLU/NLG integration, knowledge bases, learning, visualization
   - **ZFC Status**: Compliant (external integrations)
   - **Priority**: 0 (nice-to-have enhancements)

**Rationale**: These are optional enhancements, not core IBDM functionality.

---

## Recommended Priority Restructuring

### Phase Priorities (Higher number = Higher priority)

| Phase | Current | Recommended | Reason |
|-------|---------|-------------|--------|
| Phase 1: Core Foundation | 0 | **3** | Larsson algorithms (ZFC violation, research core) |
| Phase 2: Burr Integration | 1 | **2** | Orchestration shell (ZFC compliant) |
| Phase 3: Rule Development | 1 | **2-3** | Mixed (split tasks by ZFC compliance) |
| Phase 4: Accommodation | 2 | **1** | Advanced dialogue (ZFC violation) |
| Phase 5: Multi-Agent | 2 | **1** | Orchestration extension (ZFC compliant) |
| Phase 6: Grounding/ICM | 2 | **1** | Advanced dialogue (ZFC violation) |
| Phase 7: Integration/Testing | 1 | **0** | End-to-end (depends on all) |
| Phase 8: Advanced Features | 3 | **0** | Optional enhancements |

### Task-Level Restructuring

**Promote to Priority 3** (HIGHEST - Core Larsson):
- `ibdm-brm.1` - Basic data structures
- `ibdm-brm.2` - Update rule system
- `ibdm-brm.3` - DialogueMoveEngine
- `ibdm-brm.4` - Unit tests
- `ibdm-63p.2` - Integration rules (move to Phase 1)
- `ibdm-63p.3` - Selection rules (move to Phase 1)

**Keep at Priority 2** (Infrastructure):
- `ibdm-zfl.1-4` - Burr integration (except visualization)
- `ibdm-63p.1` - Interpretation rules (AI delegation)
- `ibdm-63p.4` - Generation rules (AI delegation)
- `ibdm-brm.5` - Serialization

**Keep at Priority 1** (Advanced features):
- `ibdm-x1g.*` - Accommodation
- `ibdm-tty.*` - Multi-agent
- `ibdm-okw.*` - Grounding/ICM
- `ibdm-zfl.5` - Visualization

**Demote to Priority 0** (LOWEST - End-stage):
- `ibdm-dus.*` - Integration/testing
- `ibdm-xeh.*` - Advanced features

---

## ZFC Boundary Clarification

The key insight from ZFC selective compliance:

```
┌─────────────────────────────────────────────────────────────┐
│                    IBDM Architecture                         │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  NLU (ZFC ✅)          Dialogue Core (ZFC ❌)      NLG (ZFC ✅)  │
│  ↓                    ↓                          ↓          │
│  Utterance  ──────→  Larsson Rules  ──────→  Utterance     │
│  (Claude 4.5)        (Explicit Code)         (Templates/LLM)│
│                                                              │
│  ┌────────────────────────────────────────────────────┐    │
│  │         Burr State Machine (ZFC ✅)                 │    │
│  │   (Pure orchestration of above components)         │    │
│  └────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
```

**The Priority Principle**:
1. Build Larsson core FIRST (ZFC violation zone) - **Priority 3**
2. Wrap in Burr orchestration (ZFC compliant) - **Priority 2**
3. Add language interfaces (ZFC compliant) - **Priority 2**
4. Extend with advanced features - **Priority 1**
5. Test end-to-end - **Priority 0**

---

## Implementation Actions

### Immediate (Next Session):

1. **Reprioritize Phase 1 tasks**: 0 → 3
   ```bash
   # For each ibdm-brm.* task (except .5):
   # Set priority to 3
   ```

2. **Split Phase 3 by ZFC compliance**:
   - Move `ibdm-63p.2` (integration) → Phase 1, Priority 3
   - Move `ibdm-63p.3` (selection) → Phase 1, Priority 3
   - Keep `ibdm-63p.1` (interpretation) → Phase 3, Priority 2
   - Keep `ibdm-63p.4` (generation) → Phase 3, Priority 2

3. **Demote end-stage work**:
   - Phase 7: 1 → 0
   - Phase 8: 3 → 0

### Work Order (Based on ZFC Principles):

**Week 1-2** (Priority 3 - Larsson Core):
1. Data structures (`ibdm-brm.1`)
2. Update rules (`ibdm-brm.2`)
3. Integration rules (`ibdm-63p.2`)
4. Selection rules (`ibdm-63p.3`)
5. DialogueMoveEngine (`ibdm-brm.3`)
6. Tests (`ibdm-brm.4`)

**Week 3** (Priority 2 - Orchestration):
1. Burr state machine design (`ibdm-zfl.1`)
2. Burr actions (`ibdm-zfl.2`)
3. State transitions (`ibdm-zfl.3`)
4. Persistence (`ibdm-zfl.4`)
5. Serialization (`ibdm-brm.5`)

**Week 4** (Priority 2 - Language Interfaces):
1. Interpretation with AI (`ibdm-63p.1`)
2. Generation with AI (`ibdm-63p.4`)

**Weeks 5-8** (Priority 1 - Advanced Features):
- Accommodation (Phase 4)
- Multi-agent (Phase 5)
- Grounding/ICM (Phase 6)

**Weeks 9-10** (Priority 0 - Integration):
- Testing (Phase 7)
- Advanced features (Phase 8)

---

## Success Metrics

How to verify ZFC alignment:

### ✅ Correct ZFC Compliance Indicators:

1. **Language processing delegates to AI**:
   - Interpretation uses Claude 4.5 with prompts
   - Generation uses templates or LLM
   - No keyword matching, no heuristic parsing

2. **Dialogue core is explicit algorithms**:
   - Update rules in code (not AI-decided)
   - QUD operations are transparent stack ops
   - Selection uses priority rules we can audit

3. **Burr is pure orchestration**:
   - No decision logic in state machine
   - Actions call engines, engines are pure functions
   - All state in Burr, no hidden state in engines

### ❌ ZFC Violation Indicators (Bad):

1. **Heuristics in language processing**:
   - Keyword-based routing
   - Fallback decision trees
   - Template selection via scoring

2. **AI-driven dialogue decisions**:
   - "Ask AI what rule to apply"
   - "LLM decides next move"
   - "Semantic similarity for QUD matching"

3. **Logic in orchestration**:
   - Burr actions contain reasoning
   - State machine has conditionals beyond structural checks
   - Decisions about what to do next in Burr layer

---

## Conclusion

**Current beads priorities are inverted from ZFC principles.**

The foundational Larsson algorithms (Priority 0) should be HIGHEST priority (3), because they represent:
1. The research contribution (demonstrating Larsson works)
2. The intentional ZFC violation zone (where we use explicit algorithms)
3. The core that everything else orchestrates

**Recommended Action**: Restructure beads priorities following the table above, focusing on building the Larsson core first, then wrapping it in ZFC-compliant orchestration and language interfaces.

This aligns with CLAUDE.md Policy #14: "Use AI for what humans are bad at (language). Use explicit algorithms for what we understand (dialogue)."
